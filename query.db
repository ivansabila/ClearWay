-- Buat FUNCTION untuk update
CREATE OR REPLACE FUNCTION update_timestamp()
RETURNS TRIGGER AS $$
BEGIN
    NEW.updated_at = CURRENT_TIMESTAMP;
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

-- Buat TRIGGER di tabel users
CREATE TRIGGER trigger_update_timestamp
BEFORE UPDATE ON users
FOR EACH ROW
EXECUTE FUNCTION update_timestamp();

CREATE TABLE users (
	id SERIAL PRIMARY KEY,
	full_name VARCHAR(100) NOT NULL,
	email VARCHAR(100) NOT NULL,
	phone VARCHAR(12) NOT NULL,
	password VARCHAR(100) NOT NULL,
	image VARCHAR(100) NOT NULL,
	role VARCHAR(50) NOT NULL,
	nik VARCHAR(100),
	birthPlace VARCHAR(100),
	birthDate VARCHAR(100),
	address VARCHAR(100), 
	sex CHAR(1),
	district VARCHAR(100),
	subDistrict VARCHAR(100),
	religion VARCHAR(100),
	job VARCHAR(100),
	imageKTP VARCHAR(100),
	created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
	updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
)